<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

{% load project_tags %}
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
		
    <title>{{project.name}}</title>
	<link rel="stylesheet" type="text/css" href="/static/main.css" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript"></script>
	<script src="http://www.openlayers.org/api/OpenLayers.js" type="text/javascript"></script>
    <script type="text/javascript">

    function initialize() {
		var map = new OpenLayers.Map( 'map_canvas');
		var layer = new OpenLayers.Layer.WMS( "OpenLayers WMS",
		"http://labs.metacarta.com/wms/vmap0", {layers: 'basic'} );
		map.addLayer(layer);
		

		map.setCenter(new OpenLayers.LonLat({{project.longitude}}, 
						      {{project.latitude}}));
		

		var markers = new OpenLayers.Layer.Markers( "Markers" );
		map.addLayer(markers);
					
		var size = new OpenLayers.Size(10,17);
		var offset = new OpenLayers.Pixel(-(size.w/2), -size.h);
		var icon = new OpenLayers.Icon('/static/red-marker.png',size,offset);   
		markers.addMarker(new OpenLayers.Marker
						 (new OpenLayers.LonLat({{project.longitude}}, 
						      {{project.latitude}}),icon.clone()));
		
		addsubprojects(markers);   
    }

    function addsubprojects(markers) {
      {% for subproject in subprojects %}
		var size = new OpenLayers.Size(10,17);
		var offset = new OpenLayers.Pixel(-(size.w/2), -size.h);
		var icon = new OpenLayers.Icon('/static/mini-blue-marker.png',size,offset);   
		markers.addMarker(new OpenLayers.Marker
						 (new OpenLayers.LonLat({{subproject.longitude}}, 
						      {{subproject.latitude}}),icon.clone()));      
      {% endfor %}
       
    }

    </script>
  </head>

  <body onload="initialize()">
	
				<div id="project_details">
						<div id="project_name">
							<label>Name : </label>
							<span>{{project.name}}</span>
						</div>

                        <div id="project_implementors">
						{% if project.implementor_set %}
							<p>Project Implementors : </p>
								{{implementors}}
						{% endif %}
						</div>                      
                        <p/>               
						<div id="project description">
							<label>Description: </label>
							<span>{{project.description}}</span>
						</div>
						
						<div id="project location">
								<label>Location: </label>
								<span>{{project.location}}</span>
                        </div>

                        <div id="project_website">
                            <label>Project WebSite: </label>
                            <span><a href="{{project.website_url}}">{{project.name}} home page</a></span>
                        </div>
                        
                        <div id="parent_project">
                          {% if project.parent_project %}
                            <label>Main Project : </label>
                            <div><a href="/projects/id/{{project.parent_project.id}}/">{{project.parent_project.name}}</a></div>
                          {% endif %}
                        </div>
                        
                        <div id="subprojects">
                          {% if subprojects %}
                            <label>Sub Projects : </label>
                            {% for subproject in subprojects %}
                              <div><a href="/projects/id/{{subproject.id}}/">{{subproject.name}}</a></div>
                            {% endfor %}
                          {% endif %}
                        </div>                        

                        <div id="project_image">
                            <span><img alt={{project.name}} src="{{project.project_image}}"/></span>
                        </div>
                        
						{% if project.link_set %}
							<div id="project links">
								<p>Links : </p>
								{% for link in links %}
									<div><a href="{{link.url}}">{{link.title}}</a></div>
								{% endfor %}
							</div>	
						{% endif %}
						
				  </div>
                  <p/>
	
				<div id="map_canvas" class="olMap" style="width: 512px; height:256px; border=1px solid #CCCCCC"></div>
                                <div id="photo_set">
                                    {% parse_img_rss_feed %}
                                    {% include 'photo_gallery.html' %}
                                </div>
  </body>
</html>
