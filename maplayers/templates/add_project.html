{% extends "base.html" %}
{% load i18n %}
{% load project_tags %}

{% block title_extra %} &mdash; {{title}}{% endblock %}

{% block extrahead %}
        <link rel="stylesheet" href="{{ css_url }}/add_project.css" type="text/css" />
        <script type="text/javascript" src="{{ mootools }}"></script>
        <script src="{{ jquery }}" type="text/javascript"></script>
		<script src="{{ openlayers }}" type="text/javascript"></script>
        <link rel="stylesheet" href="{{ jquery_plugins_url }}/jquery.autocomplete.css" type="text/css" />
        <script type="text/javascript" src="{{ jquery_plugins_url }}/jquery.autocomplete.min.js"></script>
        <script type="text/javascript" src="{{ fancyuploader }}/Swiff.Uploader.js"></script>
        <script type="text/javascript" src="{{ fancyuploader }}/Fx.ProgressBar.js"></script>
        <script type="text/javascript" src="{{ fancyuploader }}/FancyUpload3.Attach.js"></script>
        <script type="text/javascript" src="{{ tinymce_url }}"></script>

		<script type="text/javascript">
			jQuery.noConflict();
			var project_id = "{{project.id}}";
			var fancy_uploader_swf = "{{ fancyuploader_swf }}";
			var link_id = 0;
			var video_id = 1;
			var sectors = "{{sectors}}";
			var implementors = "{{implementors}}";
			var project_links = '{% project_links title_and_values %}';
		</script>

        <script type="text/javascript" src="{{ js_url }}/add_project.js"></script>
        <script type="text/javascript" src="{{ js_url }}/fileupload.js"></script>
{% endblock %}

{% block page_content %}
	<div id="add_project">
		<form action="/{{action}}" method="post">
			<input type="hidden" name="project_id" value="{{project.id}}"></input>
			<fieldset>
				<legend><span>About the Project</span></legend>
				<div>
					<label for="id_name">Name:</label> 
					{{form.name}}
					{{ form.name.errors }}
				</div>

                                {% sub_project_header parent_project %}					
				
				<div>
					<label for="id_description">Description:</label> 
					{{form.description}}
					{{ form.description.errors }}					
				</div>
			</fieldset>
			<fieldset>
				<legend><span>Location Information</span></legend>				
				<div>
					<label for="id_latitude">Latitude:</label> 
					{{ form.latitude }}
					{{ form.latitude.errors }}					
				</div>
				<div>				
					<label for="id_longitude">Longitude:</label> 
					{{ form.longitude }}
					{{ form.longitude.errors }}					
				</div>
				<div>				
					<label for="id_location">Location:</label> 
					{{ form.location }}
					{{ form.location.errors}}					
				</div>
			</fieldset>	
			<div id="map" class="smallmap"></div>				
			
			<fieldset>
				<legend><span>Media Information</span></legend>				
				<div>
					<label for="id_website_url">Website url:</label> 
					{{ form.website_url }}
					{{ form.website_url.errors}}					
				</div>	
				<div>
					<label for="id_project_image">Project image:</label> 
					{{ form.project_image }}
					{{ form.project_image.errors}}					
				</div>
				{% video_url_tag video_urls %}
				<div id="add_video_link"><span id="add_video">Add another video</span></div>
				
				<!-- <div>
					<label for="id_youtube_playlist_id">Youtube playlist: </label> 
					{{ form.youtube_playlist_id }}
					{{ form.youtube_playlist_id.errors }}					
				</div>	 -->
				<div>
					<label for="id_imageset_feedurl">Image set feed url: </label> 
					{{ form.imageset_feedurl }}
					{{ form.imageset_feedurl.errors }}					
				</div>
			</fieldset>	
			<fieldset>
				<legend><span>Project Filters</span></legend>				
				<div>
					<label for="id_project_sectors">Sectors: </label> 
					{{ form.project_sectors }} 
					<div>(Eg : {{sectors}})</div>
					{{ form.project_sectors.errors}}					
				</div>	
				<div>
					<label for="id_project_implementors">Implementors: </label> 
					{{ form.project_implementors }}
					<div>(Eg : {{implementors}})</div>
					{{ form.project_implementors.errors}}					
				</div>
				<div id="project-tags">
					<label for="id_project_tags">Project tags: </label> 
					{{ form.tags }}
					<div>Space separated tags</div>
				</div>
			</fieldset>
			<fieldset>
				<legend><span>Additional Information</span></legend>				
				<div id="file">
					{% file_list resources %}
					<a href="#" id="file-attach" name="file-attach">Attach a file</a>
					<ul id="file-list"></ul><a href="#" id="file-attach-2" style="display: none;" name="file-attach-2">Attach another file</a>
				</div>
				<div id="project-links"></div>
				<a href="#" id="add_link">Add another link</a>
			</fieldset>
			
			{% if publishable %}
			<div id="publish_project">
				<input type="checkbox" name="publish_project" {{checked}} />
				<span>Publish this project</span>
			</div>
			{% endif %}
			<div class="main_action">
				<input type="submit" value="{{submit_label}}" />
			</div>
		</form>
		
		<div id="comments">{% project_comments project mode %}</div>
	</div>	
{% endblock %}
